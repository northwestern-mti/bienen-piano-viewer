<!doctype html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>MTI Piano Viewer</title>
	<meta
		name="viewport"
		content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
	/>
	<meta name="author" content="Don McCurdy" />
	<meta name="description" content="Drag-and-drop preview tool for glTF 2.0 3D models." />
	<link rel="canonical" href="https://gltf-viewer.donmccurdy.com/" />
	<link rel="shortcut icon" href="/favicon.ico" />
	<link rel="stylesheet" href="style.css" />
	<link href="https://fonts.googleapis.com/css?family=Raleway:300,400" rel="stylesheet" />

	<script type="importmap">
		{
			"imports": {
				"three":         "https://cdn.jsdelivr.net/npm/three@0.162.0/build/three.module.js",
				"three/addons/": "https://cdn.jsdelivr.net/npm/three@0.162.0/examples/jsm/",
				"lil-gui":       "https://cdn.jsdelivr.net/npm/lil-gui@0.19.2/dist/lil-gui.esm.js"
			}
		}
	</script>
	<script defer type="module" src="src/app.js"></script>
</head>

<body>
	<header>
		<h1><a href="/">MTI Piano Viewer</a></h1>
	</header>

	<main class="wrap">
		<div class="dropzone">
			<div class="placeholder">
				<p>Choose a song to get started</p>
				<button onclick="chooseSong('homesweethome')">Home, Sweet Home</button>
				<button onclick="chooseSong('lachasse')">La Chasse (The Hunt)</button>
			</div>
		</div>
		<div class="spinner"></div>

		<!-- Scrub Bar -->
		<div id="scrub-bar-container" class="scrub-bar-container">
			<audio id="piano-audio"></audio>

			<!-- Play/Pause Button -->
			<button id="play-button" class="scrub-bar-play-button" onclick={VIEWER.scrubBar.play()}>Play</button>

			<!-- Progress Bar -->
			<input id='seek-range'
				class="scrub-bar-progress-bar"
				type="range" value='0' step="0.01"
				onmousedown={VIEWER.scrubBar.startScrub()} onmouseup={VIEWER.scrubBar.endScrub()} oninput={VIEWER.scrubBar.seekTo(event)}
			></input>

			<!-- Timestamps -->
			<div class="scrub-bar-timestamps">
				<span id="scrub-current-time"></span> / <span id="scrub-total-time"></span>
			</div>
		</div>
		<!-- /Scrub Bar -->

	</main>

	<footer>
		<a class="item" target="_blank" href="https://mti.it.northwestern.edu/">
			Northwestern Media & Technology Innovation
		</a>
		<span class="separator" aria-hidden="true">|</span>
		<a class="item" target="_blank" href="https://threejs.org/">
			three.js<span id="footer-three-js-version"></span>
		</a>
		<span class="separator" aria-hidden="true">|</span>
		<a
			class="item"
			target="_blank"
			href="https://github.com/northwestern-mti/bienen-piano-viewer/issues/new"
		>
			help & feedback
		</a>
		<span class="separator" aria-hidden="true">|</span>
		<a class="item" target="_blank" href="https://github.com/northwestern-mti/bienen-piano-viewer">
			github
		</a>
	</footer>
</body>

<script>
	function chooseSong(songName) {
		const rootPath = 'https://mti-demos.s3.amazonaws.com/bienan-piano/assets';

		// Update the audio source
		const audio = document.getElementById('piano-audio')
		audio.src = `${rootPath}/audio/${songName}.mp3`;

		// View the model
		window.VIEWER.app.view(`/models/${songName}.glb`, rootPath, new Map())
	}
</script>
